# 安全环境变量配置示例
# 复制此文件为 .env 并填入实际值

# ===========================================
# 核心安全配置
# ===========================================

# 主密钥 - 用于加密其他密钥和敏感数据
# 生成方式: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECURITY_MASTER_KEY=your-master-key-here

# JWT密钥 - 用于签名JWT令牌
# 生成方式: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=your-jwt-secret-key-here

# JWT配置
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ===========================================
# 数据库配置
# ===========================================

# 数据库路径
SECURITY_DB_PATH=security.db

# 数据库加密密钥（可选）
DATABASE_ENCRYPTION_KEY=your-db-encryption-key-here

# ===========================================
# API安全配置
# ===========================================

# API基础URL
API_BASE_URL=http://localhost:8000

# CORS允许的源
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# 速率限制配置
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BLOCK_DURATION_SECONDS=300

# ===========================================
# 第三方服务API密钥
# ===========================================

# DeepSeek API
DEEPSEEK_API_KEY=your-deepseek-api-key-here
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1

# OpenAI API（可选）
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_BASE_URL=https://api.openai.com/v1

# ===========================================
# 邮件服务配置
# ===========================================

# SMTP配置
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-email-password
SMTP_USE_TLS=true

# ===========================================
# 短信服务配置
# ===========================================

# 阿里云短信服务
ALIYUN_SMS_ACCESS_KEY_ID=your-access-key-id
ALIYUN_SMS_ACCESS_KEY_SECRET=your-access-key-secret
ALIYUN_SMS_SIGN_NAME=your-sms-sign-name
ALIYUN_SMS_TEMPLATE_CODE=your-template-code

# ===========================================
# 日志配置
# ===========================================

# 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# 日志文件路径
LOG_FILE_PATH=logs/security.log

# 日志保留天数
LOG_RETENTION_DAYS=30

# ===========================================
# 监控和告警配置
# ===========================================

# 启用安全监控
ENABLE_SECURITY_MONITORING=true

# 威胁检测敏感度 (low, medium, high)
THREAT_DETECTION_SENSITIVITY=medium

# 告警邮箱
ALERT_EMAIL=admin@yourdomain.com

# ===========================================
# 备份配置
# ===========================================

# 自动备份间隔（小时）
BACKUP_INTERVAL_HOURS=24

# 备份保留天数
BACKUP_RETENTION_DAYS=7

# 备份存储路径
BACKUP_STORAGE_PATH=backups/

# ===========================================
# 开发环境配置
# ===========================================

# 环境类型 (development, staging, production)
ENVIRONMENT=development

# 调试模式
DEBUG=false

# 启用详细日志
VERBOSE_LOGGING=false

# ===========================================
# 生产环境安全配置
# ===========================================

# 强制HTTPS
FORCE_HTTPS=true

# 安全头配置
ENABLE_SECURITY_HEADERS=true

# 内容安全策略
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# ===========================================
# 密钥轮换配置
# ===========================================

# 自动密钥轮换间隔（天）
KEY_ROTATION_INTERVAL_DAYS=90

# 密钥历史保留数量
KEY_HISTORY_RETENTION_COUNT=5

# ===========================================
# 会话配置
# ===========================================

# 会话超时时间（分钟）
SESSION_TIMEOUT_MINUTES=30

# 记住我功能的有效期（天）
REMEMBER_ME_DAYS=30

# ===========================================
# 文件上传安全配置
# ===========================================

# 最大文件大小（MB）
MAX_FILE_SIZE_MB=10

# 允许的文件类型
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,text/plain,application/pdf

# 文件存储路径
FILE_STORAGE_PATH=uploads/

# ===========================================
# IP白名单/黑名单配置
# ===========================================

# 管理员IP白名单（逗号分隔）
ADMIN_IP_WHITELIST=127.0.0.1,::1

# 自动封禁配置
AUTO_BAN_ENABLED=true
AUTO_BAN_THRESHOLD=5
AUTO_BAN_DURATION_MINUTES=30

# ===========================================
# 审计配置
# ===========================================

# 启用审计日志
ENABLE_AUDIT_LOG=true

# 审计日志详细级别 (basic, detailed, full)
AUDIT_LOG_LEVEL=detailed

# 审计日志保留天数
AUDIT_LOG_RETENTION_DAYS=90

# ===========================================
# 性能配置
# ===========================================

# 数据库连接池大小
DB_POOL_SIZE=10

# 请求超时时间（秒）
REQUEST_TIMEOUT_SECONDS=30

# 并发请求限制
MAX_CONCURRENT_REQUESTS=100

# ===========================================
# 特殊功能配置
# ===========================================

# 启用双因素认证
ENABLE_2FA=false

# 启用设备指纹识别
ENABLE_DEVICE_FINGERPRINTING=false

# 启用地理位置验证
ENABLE_GEO_VALIDATION=false

# ===========================================
# 注意事项
# ===========================================

# 1. 所有密钥都应该使用强随机生成器生成
# 2. 生产环境中绝不要使用默认值
# 3. 定期轮换所有密钥和密码
# 4. 使用环境变量管理工具（如 HashiCorp Vault）
# 5. 确保 .env 文件不被提交到版本控制系统
# 6. 定期审查和更新安全配置
